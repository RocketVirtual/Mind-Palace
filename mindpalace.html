<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Mind Palace MP4-360</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0, shrink-to-fit=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <script src="http://rocketvirtual.com/webvr/aframe-master/dist/aframe-v0.7.1.js"></script>
    <script src="http://rocketvirtual.com/webvr/aframe-event-set-component-master/dist/aframe-event-set-component.min.js"></script>
    <script src="http://rocketvirtual.com/webvr/aframe-environment-component-master/dist/aframe-environment-component.min.js"></script>
    <script src="http://rocketvirtual.com/webvr/aframe-super-hands-component-master/dist/super-hands.min.js"></script>
    <script src="http://rocketvirtual.com/webvr/aframe-extras-master/dist/aframe-extras.min.js"></script>
    <script src="http://rocketvirtual.com/webvr/aframe-rounded-master/dist/aframe-rounded-component.min.js"></script>
    
    <script src="https://unpkg.com/aframe-animation-component/dist/aframe-animation-component.min.js"></script>


    <style type="text/css">
      #video-permission {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: white;
          z-index: 10000;
          display: none;
      }
      #video-permission-button {
        position: fixed;
        top: calc(50% - 1em);
        left: calc(50% - 60px);
        width: 120px;
        height: 2em;
      }
    </style>

    <link rel="stylesheet" type="text/css" href="http://rocketvirtual.com/webvr/aframe-super-hands-component-master/examples/assets/examples.css">

    <script type="text/javascript">

      AFRAME.registerComponent('auto-enter-vr', {
        init: function () {
          this.el.sceneEl.enterVR();
        }
      });

      function setScene1() {
        document.getElementById('VRdesk').setAttribute('visible', 'true')

        document.getElementById('scenePlace1').setAttribute('visible', 'false')
        document.getElementById('scenePlace2').setAttribute('visible', 'false')
        document.getElementById('scenePlace3').setAttribute('visible', 'false')
        document.getElementById('scenePlace4').setAttribute('visible', 'false')
        document.getElementById('scenePlace5').setAttribute('visible', 'false')
        document.getElementById('scenePlace6').setAttribute('visible', 'false')
        document.getElementById('scenePlace7').setAttribute('visible', 'false')
        document.getElementById('scenePlace8').setAttribute('visible', 'false')
        document.getElementById('scenePlace9').setAttribute('visible', 'false')

      }

      function setScenePlace1() {
        document.getElementById('VRdesk').setAttribute('visible', 'false')

        document.getElementById('scenePlace1').setAttribute('visible', 'true')
        document.getElementById('scenePlace2').setAttribute('visible', 'false')
        document.getElementById('scenePlace3').setAttribute('visible', 'false')
        document.getElementById('scenePlace4').setAttribute('visible', 'false')
        document.getElementById('scenePlace5').setAttribute('visible', 'false')
        document.getElementById('scenePlace6').setAttribute('visible', 'false')
        document.getElementById('scenePlace7').setAttribute('visible', 'false')
        document.getElementById('scenePlace8').setAttribute('visible', 'false')
        document.getElementById('scenePlace9').setAttribute('visible', 'false')

      }

      function setScenePlace2() {
        document.getElementById('VRdesk').setAttribute('visible', 'false')

        document.getElementById('scenePlace1').setAttribute('visible', 'false')
        document.getElementById('scenePlace2').setAttribute('visible', 'true')
        document.getElementById('scenePlace3').setAttribute('visible', 'false')
        document.getElementById('scenePlace4').setAttribute('visible', 'false')
        document.getElementById('scenePlace5').setAttribute('visible', 'false')
        document.getElementById('scenePlace6').setAttribute('visible', 'false')
        document.getElementById('scenePlace7').setAttribute('visible', 'false')
        document.getElementById('scenePlace8').setAttribute('visible', 'false')
        document.getElementById('scenePlace9').setAttribute('visible', 'false')

      }

      function setScenePlace3() {
        document.getElementById('VRdesk').setAttribute('visible', 'false')

        document.getElementById('scenePlace1').setAttribute('visible', 'false')
        document.getElementById('scenePlace2').setAttribute('visible', 'false')
        document.getElementById('scenePlace3').setAttribute('visible', 'true')
        document.getElementById('scenePlace4').setAttribute('visible', 'false')
        document.getElementById('scenePlace5').setAttribute('visible', 'false')
        document.getElementById('scenePlace6').setAttribute('visible', 'false')
        document.getElementById('scenePlace7').setAttribute('visible', 'false')
        document.getElementById('scenePlace8').setAttribute('visible', 'false')
        document.getElementById('scenePlace9').setAttribute('visible', 'false')

      }

      function setScenePlace4() {
        document.getElementById('VRdesk').setAttribute('visible', 'false')

        document.getElementById('scenePlace1').setAttribute('visible', 'false')
        document.getElementById('scenePlace2').setAttribute('visible', 'false')
        document.getElementById('scenePlace3').setAttribute('visible', 'false')
        document.getElementById('scenePlace4').setAttribute('visible', 'true')
        document.getElementById('scenePlace5').setAttribute('visible', 'false')
        document.getElementById('scenePlace6').setAttribute('visible', 'false')
        document.getElementById('scenePlace7').setAttribute('visible', 'false')
        document.getElementById('scenePlace8').setAttribute('visible', 'false')
        document.getElementById('scenePlace9').setAttribute('visible', 'false')

      }

      function setScenePlace5() {
        document.getElementById('VRdesk').setAttribute('visible', 'false')

        document.getElementById('scenePlace1').setAttribute('visible', 'false')
        document.getElementById('scenePlace2').setAttribute('visible', 'false')
        document.getElementById('scenePlace3').setAttribute('visible', 'false')
        document.getElementById('scenePlace4').setAttribute('visible', 'false')
        document.getElementById('scenePlace5').setAttribute('visible', 'true')
        document.getElementById('scenePlace6').setAttribute('visible', 'false')
        document.getElementById('scenePlace7').setAttribute('visible', 'false')
        document.getElementById('scenePlace8').setAttribute('visible', 'false')
        document.getElementById('scenePlace9').setAttribute('visible', 'false')

      }

      function setScenePlace6() {
        document.getElementById('VRdesk').setAttribute('visible', 'false')

        document.getElementById('scenePlace1').setAttribute('visible', 'false')
        document.getElementById('scenePlace2').setAttribute('visible', 'false')
        document.getElementById('scenePlace3').setAttribute('visible', 'false')
        document.getElementById('scenePlace4').setAttribute('visible', 'false')
        document.getElementById('scenePlace5').setAttribute('visible', 'false')
        document.getElementById('scenePlace6').setAttribute('visible', 'true')
        document.getElementById('scenePlace7').setAttribute('visible', 'false')
        document.getElementById('scenePlace8').setAttribute('visible', 'false')
        document.getElementById('scenePlace9').setAttribute('visible', 'false')

      }

      function setScenePlace7() {
        document.getElementById('VRdesk').setAttribute('visible', 'false')

        document.getElementById('scenePlace1').setAttribute('visible', 'false')
        document.getElementById('scenePlace2').setAttribute('visible', 'false')
        document.getElementById('scenePlace3').setAttribute('visible', 'false')
        document.getElementById('scenePlace4').setAttribute('visible', 'false')
        document.getElementById('scenePlace5').setAttribute('visible', 'false')
        document.getElementById('scenePlace6').setAttribute('visible', 'false')
        document.getElementById('scenePlace7').setAttribute('visible', 'true')
        document.getElementById('scenePlace8').setAttribute('visible', 'false')
        document.getElementById('scenePlace9').setAttribute('visible', 'false')

      }

      function setScenePlace8() {
        document.getElementById('VRdesk').setAttribute('visible', 'false')

        document.getElementById('scenePlace1').setAttribute('visible', 'false')
        document.getElementById('scenePlace2').setAttribute('visible', 'false')
        document.getElementById('scenePlace3').setAttribute('visible', 'false')
        document.getElementById('scenePlace4').setAttribute('visible', 'false')
        document.getElementById('scenePlace5').setAttribute('visible', 'false')
        document.getElementById('scenePlace6').setAttribute('visible', 'false')
        document.getElementById('scenePlace7').setAttribute('visible', 'false')
        document.getElementById('scenePlace8').setAttribute('visible', 'true')
        document.getElementById('scenePlace9').setAttribute('visible', 'false')

      }

      function setScenePlace9() {
        document.getElementById('VRdesk').setAttribute('visible', 'false')

        document.getElementById('scenePlace1').setAttribute('visible', 'false')
        document.getElementById('scenePlace2').setAttribute('visible', 'false')
        document.getElementById('scenePlace3').setAttribute('visible', 'false')
        document.getElementById('scenePlace4').setAttribute('visible', 'false')
        document.getElementById('scenePlace5').setAttribute('visible', 'false')
        document.getElementById('scenePlace6').setAttribute('visible', 'false')
        document.getElementById('scenePlace7').setAttribute('visible', 'false')
        document.getElementById('scenePlace8').setAttribute('visible', 'false')
        document.getElementById('scenePlace9').setAttribute('visible', 'true')

      }

  </script>
  </head>
  <body>

    <div id="video-permission">
      <button id="video-permission-button">Allow VR video</button>
    </div>

    <a-scene touch-to-click-converter>
      <a-assets>
        <img id="place1" src="http://rocketvirtual.com/webvr/images/360/SAM_100_0070.jpg">
        <img id="place2" src="http://rocketvirtual.com/webvr/images/360/SAM_100_0016.jpg">
        <img id="place3" src="http://rocketvirtual.com/webvr/images/360/SAM_101_0032.jpg">
        <img id="place4" src="http://rocketvirtual.com/webvr/images/360/SAM_101_0021.jpg">
        <img id="place5" src="http://rocketvirtual.com/webvr/images/360/SAM_100_0128.jpg">
        <img id="place6" src="http://rocketvirtual.com/webvr/images/360/SAM_100_0112.jpg">
        <img id="place7" src="http://rocketvirtual.com/webvr/images/360/SAM_101_0068.jpg">
        <img id="place8" src="http://rocketvirtual.com/webvr/images/360/SAM_101_0044.jpg">
        <img id="place9" src="http://rocketvirtual.com/webvr/images/360/SAM_101_0035.jpg">

        <img id="desktop" src="http://rocketvirtual.com/webvr/images/360/VRdesktop.png">

        <img id="place1_thumb" src="http://rocketvirtual.com/webvr/images/360/thumb/SAM_100_0070_thumb.jpg">
        <img id="place2_thumb" src="http://rocketvirtual.com/webvr/images/360/thumb/SAM_100_0016_thumb.jpg">
        <img id="place3_thumb" src="http://rocketvirtual.com/webvr/images/360/thumb/SAM_101_0032_thumb.jpg">
        <img id="place4_thumb" src="http://rocketvirtual.com/webvr/images/360/thumb/SAM_101_0021_thumb.jpg">
        <img id="place5_thumb" src="http://rocketvirtual.com/webvr/images/360/thumb/SAM_100_0128_thumb.jpg">
        <img id="place6_thumb" src="http://rocketvirtual.com/webvr/images/360/thumb/SAM_100_0112_thumb.jpg">
        <img id="place7_thumb" src="http://rocketvirtual.com/webvr/images/360/thumb/SAM_101_0068_thumb.jpg">
        <img id="place8_thumb" src="http://rocketvirtual.com/webvr/images/360/thumb/SAM_101_0044_thumb.jpg">
        <img id="place9_thumb" src="http://rocketvirtual.com/webvr/images/360/thumb/SAM_101_0035_thumb.jpg">

        <img id="desktop_thumb" src="http://rocketvirtual.com/webvr/images/360/thumb/VRdesktop_thumb.jpg">

        <img id="back" src="http://rocketvirtual.com/webvr/images/back.png">

        <a-mixin id="marble" scale=".30 .30 .30" material="color: white" shadow ></a-mixin>

        <img src="http://rocketvirtual.com/webvr/assets/play.png" id="play" crossorigin="anonymous">
        <img src="http://rocketvirtual.com/webvr/assets/pause.png" id="pause" crossorigin="anonymous">
        <img src="http://rocketvirtual.com/webvr/assets/volume-normal.png" id="volume-normal" crossorigin="anonymous">
        <img src="http://rocketvirtual.com/webvr/assets/volume-mute.png" id="volume-mute" crossorigin="anonymous">
        <img src="http://rocketvirtual.com/webvr/assets/seek-back.png" id="seek-back" crossorigin="anonymous">

        <img src="http://rocketvirtual.com/webvr/assets/white_grid_thin.png" id="grid" crossorigin="anonymous">
        <video id="video-src" src="http://rocketvirtual.com/webvr/video/beach.mp4"></video>        

    </a-assets>

      <a-entity progressive-controls="objects: .clickable, a-link; maxLevel: point" mouse-cursor>
          <a-entity id="rhand" class="right-controller"></a-entity>
          <a-entity laser-controls line="color: limegreen; opacity: 0.75" raycaster="far: 5"></a-entity>
      </a-entity>

      <a-entity id="menu_scene" visible="true">
          <a-sky id="VRdesk" material="src: #desktop" rotation="0 105 0" ></a-sky>
      
          <a-sphere class="clickable" mixin="marble" position="-2 -1 -4.5" rotation="0 0 0" material="src: #place1_thumb" onclick="setScenePlace1()" look-controls></a-sphere>
          <a-sphere class="clickable" mixin="marble" position="-1 -1 -4.5" rotation="0 -75 0" material="src: #place2_thumb" onclick="setScenePlace2()" look-controls></a-sphere>
          <a-sphere class="clickable" mixin="marble" position="0 -1 -4.5" rotation="0 -45 0" material="src: #place3_thumb" onclick="setScenePlace3()" look-controls></a-sphere>
          <a-sphere class="clickable" mixin="marble" position="1 -1 -4.5" rotation="0 -45 0" material="src: #place4_thumb" onclick="setScenePlace4()" look-controls></a-sphere>
          <a-sphere class="clickable" mixin="marble" position="2 -1 -4.5" rotation="0 -75 0" material="src: #place5_thumb" onclick="setScenePlace5()" look-controls></a-sphere>
          <a-sphere class="clickable" mixin="marble" position="-1.5 -1.5 -4" rotation="0 0 0" material="src: #place6_thumb" onclick="setScenePlace6()" look-controls></a-sphere>
          <a-sphere class="clickable" mixin="marble" position="-.5 -1.5 -4" rotation="0 -75 0" material="src: #place7_thumb" onclick="setScenePlace7()" look-controls></a-sphere>
          <a-sphere class="clickable" mixin="marble" position=".5 -1.5 -4" rotation="0 -45 0" material="src: #place8_thumb" onclick="setScenePlace8()" look-controls></a-sphere>
          <a-sphere class="clickable" mixin="marble" position="1.5 -1.5 -4" rotation="0 -45 0" material="src: #place9_thumb" onclick="setScenePlace9()" look-controls></a-sphere>
          
      <!-- MEDIAS HOLDER -->
      <a-sound id="alert-sound" src="src: url(http://rocketvirtual.com/webvr/assets/action.wav)" autoplay="false" position="0 0 0"></a-sound>
      <a-video id="video-screen" src="#video-src" position="0 3.119 -9.575" width="8" height="4" rotation="0 -0.17188733853924698 -0.9740282517223996" visible="false"></a-video>
      <!-- END MEDIAS HOLDER -->

      <!-- CONTROLS -->
      <a-image class="clickable" id="control-back" width="0.4" height="0.4" src="#seek-back" position="-0.8 0.6 -6" visible="false" scale="0.85 0.85 0.85"></a-image>
      <a-image class="clickable" id="control-play" width="0.4" height="0.4" src="#play" position="0 0.6 -6"></a-image>
      <a-image class="clickable" id="control-volume" width="0.4" height="0.4" src="#volume-normal" position="0.8 0.6 -6" visible="false" scale="0.75 0.75 0.75"></a-image>
      <!-- END CONTROLS -->

        <!-- PROGRESSBAR -->
        <a-entity id="progress-bar" geometry="primitive:plane;height:0.1;width:4" material="opacity:0;transparent:true;visible:false" position="0 0.987 -9.575" rotation="0 -0.17188733853924698 -0.9740282517223996">
          <a-plane id="progress-bar-track" width="4" height="0.1" color="black" position="0 0 0" opacity="0.2" visible="false"></a-plane>
          <a-plane id="progress-bar-fill" width="1.3027969689224046" height="0.1" color="#7198e5" position="-1.3486015155387978 0 0.01" geometry="" visible="false"></a-plane>
        <!-- END PROGRESSBAR -->

        <!-- ENVIRONMENT -->
          <a-entity light="color: #FFF; intensity: 1; type: ambient;"></a-entity>
        <!-- END ENVIRONMENT -->
        </a-entity>


      <a-rounded radius="0.1" top-left-radius="0.6" top-right-radius="0.6" bottom-left-radius="0.6" bottom-right-radius="0.6" position="-2.667 -0.606 -4.261" scale="0.661 0.218 0" rotation="-50 0 0" width="8" height="8" color="#657383" opacity=".35" shadow="">
          </a-rounded>

      <a-entity id="scenePlace1" visible="false">
      <a-sky  material="src: #place1" rotation="0 -75 0" ></a-sky>
      <a-sphere class="clickable" mixin="marble" position="-2.78 -0.736 -5.818" material="src: #desktop_thumb;color:pink"  scale=".00025 .00025 .00025" onclick="setScene1()" look-controls > </a-sphere>
        <a-plane material="src:#back" position="-2.291 0.582 -6.151" rotation="-49.73 0 0" scale="0.371 0.547 1.515" opacity=".45" ></a-plane>
      </a-entity>

      <a-entity id="scenePlace2" visible="false">
      <a-sky material="src: #place2" rotation="0 -75 0" ></a-sky>
      <a-sphere class="clickable" mixin="marble" position="-2.78 -0.736 -5.818" material="src: #desktop_thumb;color:pink" scale=".00025 .00025 .00025" onclick="setScene1()" look-controls > </a-sphere>
        <a-plane material="src:#back" position="-2.291 0.582 -6.151" rotation="-49.73 0 0" scale="0.371 0.547 1.515" opacity=".45"></a-plane>
      </a-entity>

      <a-entity id="scenePlace3" visible="false">
      <a-sky material="src: #place3" rotation="0 -45 0" ></a-sky>
      <a-sphere class="clickable" mixin="marble" position="-2.78 -0.736 -5.818" material="src: #desktop_thumb;color:pink" scale=".00025 .00025 .00025" onclick="setScene1()" look-controls > </a-sphere>
        <a-plane material="src:#back" position="-2.291 0.582 -6.151" rotation="-49.73 0 0" scale="0.371 0.547 1.515" opacity=".45"></a-plane>
      </a-entity>

      <a-entity id="scenePlace4" visible="false">
      <a-sky material="src: #place4" rotation="0 -75 0" ></a-sky>
      <a-sphere class="clickable" mixin="marble" position="-2.78 -0.736 -5.818" material="src: #desktop_thumb;color:pink" scale=".00025 .00025 .00025" onclick="setScene1()" look-controls > </a-sphere>
        <a-plane material="src:#back" position="-2.291 0.582 -6.151" rotation="-49.73 0 0" scale="0.371 0.547 1.515" opacity=".45"></a-plane>
      </a-entity>

      <a-entity id="scenePlace5" visible="false">
        <a-sky  material="src: #place5" rotation="0 0 0" ></a-sky>
        <a-sphere class="clickable" mixin="marble" position="-2.78 -0.736 -5.818" material="src: #desktop_thumb;color:pink"  scale=".00025 .00025 .00025" onclick="setScene1()" look-controls > </a-sphere>
        <a-plane material="src:#back" position="-2.291 0.582 -6.151" rotation="-49.73 0 0" scale="0.371 0.547 1.515" opacity=".45" ></a-plane>
      </a-entity>

      <a-entity id="scenePlace6" visible="false">
        <a-sky material="src: #place6" rotation="0 -45 0" ></a-sky>
        <a-sphere class="clickable" mixin="marble" position="-2.78 -0.736 -5.818" material="src: #desktop_thumb;color:pink" scale=".00025 .00025 .00025" onclick="setScene1()" look-controls > </a-sphere>
        <a-plane material="src:#back" position="-2.291 0.582 -6.151" rotation="-49.73 0 0" scale="0.371 0.547 1.515" opacity=".45"></a-plane>
      </a-entity>

      <a-entity id="scenePlace7" visible="false">
        <a-sky material="src: #place7" rotation="0 -75 0" ></a-sky>
        <a-sphere class="clickable" mixin="marble" position="-2.78 -0.736 -5.818" material="src: #desktop_thumb;color:pink" scale=".00025 .00025 .00025" onclick="setScene1()" look-controls > </a-sphere>
        <a-plane material="src:#back" position="-2.291 0.582 -6.151" rotation="-49.73 0 0" scale="0.371 0.547 1.515" opacity=".45"></a-plane>
      </a-entity>

      <a-entity id="scenePlace8" visible="false">
        <a-sky  material="src: #place8" rotation="0 -75 0" ></a-sky>
        <a-sphere class="clickable" mixin="marble" position="-2.78 -0.736 -5.818" material="src: #desktop_thumb;color:pink"  scale=".00025 .00025 .00025" onclick="setScene1()" look-controls > </a-sphere>
        <a-plane material="src:#back" position="-2.291 0.582 -6.151" rotation="-49.73 0 0" scale="0.371 0.547 1.515" opacity=".45" ></a-plane>
      </a-entity>

      <a-entity id="scenePlace9" visible="false">
        <a-sky material="src: #place9" rotation="0 -75 0" ></a-sky>
        <a-sphere class="clickable" mixin="marble" position="-2.78 -0.736 -5.818" material="src: #desktop_thumb;color:pink" scale=".00025 .00025 .00025" onclick="setScene1()" look-controls > </a-sphere>
        <a-plane material="src:#back" position="-2.291 0.582 -6.151" rotation="-49.73 0 0" scale="0.371 0.547 1.515" opacity=".45"></a-plane>
      </a-entity>

    </a-scene>


    <script type="text/javascript">

      var AVideoPlayer = function() {

      // Vals
      this.duration         = 0;
      this.current_progress = 0;
      this.progressWidth    = 4;
      this.paused           = true;

      // Elems
      this.elProgressBar   = null;
      this.elProgressTrack = null;
      this.elProgressFill  = null;
      this.elAlertSound    = null;
      this.elVideo         = null;
      this.elVideoScreen   = null;
      this.elControlBack   = null;
      this.elControlPlay   = null;
      this.elControlVolume = null;

      this._initElements = function() {
        this.elProgressBar   = document.getElementById('progress-bar');
        this.elProgressTrack = document.getElementById('progress-bar-track');
        this.elProgressFill  = document.getElementById('progress-bar-fill');
        this.elAlertSound    = document.getElementById('alert-sound');
        this.elVideo         = document.getElementById('video-src');
        this.elVideoScreen   = document.getElementById('video-screen');
        this.elControlBack   = document.getElementById('control-back');
        this.elControlPlay   = document.getElementById('control-play');
        this.elControlVolume = document.getElementById('control-volume');
      }

      /**
      * PROGRESS
      */
      this.setProgress = function(progress) {

        var new_progress = this.progressWidth*progress;
        this._setProgressWidth(new_progress);
        var progress_coord = this._getProgressCoord();
        if (progress_coord != undefined) {
         progress_coord.x = -(this.progressWidth-new_progress)/2;
         this._setProgressCoord(progress_coord);
        }
      }
      this._getProgressCoord = function() {
        return AFRAME.utils.coordinates.parse(this.elProgressFill.getAttribute("position"))
      }
      this._getProgressWidth = function() {
        return parseFloat(this.elProgressFill.getAttribute("width"));
      }
      this._setProgressCoord = function(coord) {
        this.elProgressFill.setAttribute("position", coord);
      }
      this._setProgressWidth = function(width) {
        this.elProgressFill.setAttribute("width", width);
      }

      /*
      * UI SETTERS
      */
      this.isProgressBarVisible = function(isVisible) {
        this.elProgressTrack.setAttribute("visible", isVisible);
        this.elProgressFill.setAttribute("visible", isVisible);
      }
      this.isControlVisible = function(isVisible) {
        this.elControlBack.setAttribute("visible", isVisible);
        this.elControlVolume.setAttribute("visible", isVisible);
        this.elVideoScreen.setAttribute("visible", isVisible);
      }

      /*
      * EVENTS
      */
      this._addPlayerEvents = function() {
        var that = this;
        this.elVideo.pause();
        this.elVideo.onplay = function() {
          that.duration = this.duration;
        }
        this.elVideo.ontimeupdate = function() {
          if (that.duration > 0) {
            that.current_progress = this.currentTime/that.duration;
          }
          that.setProgress(that.current_progress);
        }
      }

      this._addControlsEvent = function() {
        var that = this;

        this.elControlPlay.addEventListener('click', function () {
          that._playAudioAlert();
          if (that.elVideo.paused) {
            this.setAttribute('src', '#pause');
            that.elVideo.play();
            that.paused = false;
            that.isProgressBarVisible(true);
            that.isControlVisible(true);
          } else {
            this.setAttribute('src', '#play');
            that.elVideo.pause();
            that.paused = true;
            that.isProgressBarVisible(false);
            that.isControlVisible(false);
         }
        });

        this.elControlVolume.addEventListener('click', function () {
          that._playAudioAlert();
          if (that.elVideo.muted) {
            that.elVideo.muted = false;
            this.setAttribute('src', '#volume-normal');
          } else {
            that.elVideo.muted = true;
            this.setAttribute('src', '#volume-mute');
          }
        });

        this.elControlBack.addEventListener('click', function () {
          that._playAudioAlert();
          that.elVideo.currentTime = 0;
        });
      }

      this._addProgressEvent = function() {
        var that = this;
        this.elProgressBar.addEventListener('click', function (e) {
          if (e.detail == undefined || e.detail.intersection == undefined || that.duration === 0) {
            return;
          }
          let seekedPosition = (e.detail.intersection.point.x+(that.progressWidth/2))/that.progressWidth;
          try {
            let seekedTime = seekedPosition*that.duration;
            that.elVideo.currentTime = seekedTime;
          } catch (e) {
          }
        });
      }

      this._playAudioAlert = function() {
        if (this.elAlertSound.components !== undefined && this.elAlertSound.components.sound !== undefined) {
         this.elAlertSound.components.sound.playSound();
        }
      }

      /**
      * MOBILE PATCH TO PLAY VIDEO
      */
      this._mobileFriendly = function() {
        if (AFRAME.utils.device.isMobile()) {
          var that = this;
          let video_permission        = document.getElementById('video-permission');
         let video_permission_button = document.getElementById('video-permission-button');

          video_permission.style.display = 'block';
          video_permission_button.addEventListener("click", function() {
            video_permission.style.display = 'none';
            that.elVideo.play();
            that.elVideo.pause();
          }, false);
        }
      }

      this.init = function() {
        this._initElements();
        //this._determinateProgressWidth();
        this.setProgress(this.current_progress);
        this._addPlayerEvents();
        this._addControlsEvent();
        this._addProgressEvent();
        this._mobileFriendly();
      }

      this.init();
    }



      let scene = document.querySelector('a-scene');
      var cursor = document.querySelector('a-cursor');
      /**
      * CINEMA MODE
      */
      scene.lightOff = function() {
        scene.islightOn = true;
        scene.removeAttribute('animation__fogback');
        scene.setAttribute('animation__fog', "property: fog.color; to: #0c192a; dur: 800; easing: easeInQuad;");
      }
      scene.lightOn = function() {
        scene.islightOn = false;
        scene.removeAttribute('animation__fog');
        scene.setAttribute('animation__fogback', "property: fog.color; to: #dbdedb; dur: 800");
      }
      /**
      * AVideoPlayer
      */
      var videoPlayer = new AVideoPlayer();
      document.querySelector('#control-play').addEventListener('click', function () {
        if (videoPlayer.paused) {
          scene.lightOn()

        } else {
          scene.lightOff();

        }
      });
    </script>
  </body>
</html>